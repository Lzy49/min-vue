# 24-实现 shapeFlags
### 这节课讲了什么
- 讲了使用 shapeFlags 实现类型判定
- 使用二进制数来优化 判定过程。
### 核心
#### 二进制
- 利用二进制数 ｜ & 来做判定，来确定多权限，是否合规
  - ｜ 代表 0 ｜ 1  === 1 ， 1 ｜ 1 === 1 ， 0 ｜ 0 === 0
  - & 代表  1 & 1 === 1 ，0 & 1 === 0
- 设置权限使用 << 来设置数比如 1 << 1 === 0010 , 1 << 2 === 0100
- 多权限可以使用  | 比如 1 << 1 | 1 << 2 === 0110
- 权限判定可以使用 & 比如 0010 & 0110 > 0  , 0000 & 0010 === 0
#### 实现
在 createNode 时增加 ShapeFlags 属性
- 通过判断 type 类型来设置 元素 & 文字
- 通过判断 children 设置 有文字子元素 & 数组子元素
### 思想
ShapeFlags 思想 
- 当遇到需要校验的问题时，可以使用 ShapeFlags 来完成。它本质就是利 用一个固定的 Flag 表示一些意义。方便判断。
- 在实现Flag时可以使用二进制来完成。 这样更加高效。
### 运行流程
#### 设置元素 
h->createNode->判断type 设置 shapeFlag -> 判断 children 设置 shapeFlag
#### 判断
render->path->判断shapeFlag确定元素类型->processElement->mountElement-> 判断 shapeFlag -> 处理

# 25-实现注册事件功能
### 这节课讲讲什么  
如何实现 事件绑定
### 核心
- 判断 传入的参数中的key是否符合/^on[A-Z]/ 
- 使用 addEventListener 绑定
### 思想
### 运行流程
h->createNode->path->processElement->mountElement->处理props

# 26-实现组件 props 逻辑
### 这节课讲了什么
如何实现 props
### 核心
#### props 初始化
通过 vnode 传的 props 绑定在 instance 上
#### props 传入 setup
在调用setup 时 传入 props ，并且 props 应该是 shallowReadonly 值。
#### props 传入 this
在 componentPublic 中 实现 代理
### 技巧
- Object.prototype.hasOwnProperty.call(state, key) // 取自己
- Reflect.has(state, key)  和 key in state 相同 // 取自己 + 原型链
### 运行流程
h->createNode->path->processComponent->mountComponent->createComponentInstance 创建 instance-> setupComponent 处理各种option -> initProps 处理 vnode 传来的props->setupStatefulComponent 处理 instance ->  更新->调用 setup 传入 shallowReadonly(props) -> 处理 setup 返回值 -> setupRenderEffect 继续调用path更新组件
# 27-实现组件 emit 功能
### 这节课讲了什么
如何实现 emit 的功能
### 核心
- emit 其实是一个函数这个函数会传给 setup 的第二个参数中的对象中。
- emit 接收多个值，其中第一个值是 event 
- 通过 event 找到 props 中 on + Event 的函数并为其传参，并执行。
### 技巧
课程中再次展示TPP的思想。先实现了一个 onAdd 后面又进行了通用化 去重构 capitalize , toHandlerKey来解析 event 最后又增加了camelize对 'on-add' 字符串的支持 
### 运行流程
h->createNode -> path -> processComponent -> mountComponent -> createComponentInstance 创建 instanc -> 初始化 emit 函数 -> setupComponent 处理 option -> 更新 -> 调用 setup 传入 instanc.emit -> ...
# 28-实现组件 slots 功能
### 这节课讲了什么
slots 功能 实现
- 不具名 slots 实现
- 具名 slots 实现
- 作用域 slots 实现
### 核心
- 增加 initSlot 将 slot 处理统一。
  - 处理 函数
- 增加 ShapeFlag 来判定是否是有 slot 的组件
- 增加 this.$slots 代理 instance.vnode.children
- 增加 renderSlot 来处理 initSlot 来创建 vnode
- ### 运行流程
h->createNode->path->processComponent->mountComponent -> createComponentInstance -> setupComponent -> initSlots -> setupStatefulComponent 挂载 this.$slots -> ...